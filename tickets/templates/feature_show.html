{% extends 'base.html' %}
{% load bootstrap_tags %}
{% block page_title %}{{ feature.title }}{% endblock %}

<div class="container">
    <div class="row">
        <div class="col-sm-8 mx-auto">
            {% block page_heading %}<h3 class="main-title mb-3">{{ feature.title }}</h3>{% endblock %}
        </div>
    </div>
</div>


{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-sm-10" align="center">
                <form name="feature_edit" method="post">
                    {% csrf_token %}
                    {{ form | as_bootstrap }}
                    <button class="btn btn-create-ticket btn-sm mb-5" type="submit">Save Changes
                    </button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-10" align="center">
                {% if user_has_votes %}
                    <form name="feature_vote" method="post" action="{% url 'vote_feature' feature.id %}">
                        {% csrf_token %}
                        <button type="submit" id="upvote"><h5>Upvote</h5></button>
                    </form>
                {% endif %}

                <p class="lead my-5">{{ feature.featurevote_set.count }} Votes</p>
            </div>

            <div class="col-sm-10" align="center">

                {% if not user_has_votes %}

                    <div class="alert alert-dismissible alert-danger">
                        <button type="button" class="close" data-dismiss="alert">&times;</button>
                        <strong>Oh no!</strong> <a href="{% url 'buyvotes' %}" class="alert-link">buy feature
                        votes</a>
                        and try
                        submitting again.
                    </div>

                {% endif %}

            </div>
        </div>

        <div class="row">
            {% for comment in feature.featurecomment_set.all %}
                {% if comment.feature_id == feature.id %}
                    <div class="col-sm-10 mb-5" align="right">
                        <div class="card">
                            <div class="card-body">
                                <p class="lead"><strong>{{ comment.commenter }}</strong></p>
                                <p>{{ comment.content }}</p>
                                <p class="small">{{ comment.created_date }}</p>
                            </div>
                        </div>
                    </div>

                {% endif %}
            {% endfor %}
        </div>

        <div class="row">
            <div class="col-sm-10 mt-3" align="center">
                <form name="comment_feature" action="{% url 'comment_feature' feature.id %}" method="POST">
                    {{ comment_form.non_field_errors }}
                    {{ comment_form | as_bootstrap }}
                    {% csrf_token %}
                    <button class="btn btn-create-ticket btn-sm" type="submit">Add Comment
                    </button>
                </form>
            </div>
        </div>
    </div>


{% endblock %}
